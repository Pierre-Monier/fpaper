This is the auth business logic of the app